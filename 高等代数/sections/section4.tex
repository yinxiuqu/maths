\section{线性映射}
\subsection{线性映射与矩阵}

\begin{theorem}
  设\(V\in \mathbb{K}^n, U\in \mathbb{K}^m, W\in \mathbb{K}^p\),
  它们的基分别为\(\{e_1,e_2,\cdots,e_n\}\),\\
  \(\{f_1,f_2,\cdots,f_m\}\), \(\{g_1,g_2,\cdots,g_p\}\), \(T\)
  是从线性映射到其表示矩阵的线性同构.设\\
  \(\varphi:V \longrightarrow U\), \(\psi:U \longrightarrow W\)为两个线性映射.
  则\(\psi \circ \varphi:V \xlongrightarrow{}{W}\)为线性映射，且
  \(T(\psi \circ \varphi)=T(\psi)\cdot T(\varphi)\).
\end{theorem}

\begin{proof}
  依题意设\(T(\varphi)=A=(a_{ij})_{m\times n}\), \(T(\psi)=B=(b_{ij})_{p\times m}\).只要证\\
  \(T(\varphi\circ\psi)=BA\)即可.
  \begin{align*}
    & (\varphi(e_1),\varphi(e_2),\cdots,\varphi(e_n))=(f_1,f_2,\cdots,f_m)A\\
    & \Longleftrightarrow \varphi(e_j)=\sum_{i=1}^m a_{ij}f_i ,
      \forall 1\leq j \leq n\\
    & \xLongrightarrow{\text{将}\psi\text{作用到上式两边}}
      \psi(\varphi(e_j)) = \psi(\sum_{i=1}^m a_{ij}f_i) =
      \sum_{i=1}^m a_{ij}\psi(f_i), \forall 1\leq j \leq n\\
    & \Longrightarrow  (\psi\varphi(e_1),\psi\varphi(e_2),\cdots,\psi\varphi(e_n))
      = (\psi(f_1),\psi(f_2),\cdots,\psi(f_m))A
  \end{align*}
  \(\because (\psi(f_1),\psi(f_2),\cdots,\psi(f_n))=(g_1,g_2,\cdots,g_p)B\),\\
  \(\therefore (\psi\varphi(e_1),\psi\varphi(e_2),\cdots,\psi\varphi(e_n)) =
  (g_1,g_2,\cdots,g_p)BA\).\\
  \(\therefore T(\psi \circ \varphi)=T(\psi)\cdot T(\varphi) \).
\end{proof}

\begin{deduction}
  \(T:\mathcal{L}(V) \longrightarrow M_n(\mathbb{K})\)保持乘法，从而
  \(T\)是一个\(\mathbb{K}-\text{代数}\)同构.
\end{deduction}

\begin{deduction}
  上述\(T\)同构有下列性质：

  \((1)T(I_V) = I_n \);

  \((2)\varphi \in \mathcal{L}(V)\), 则\(\varphi\)是自同构的充要条件是\(T(\varphi)\)可逆且
  \(T(\varphi^{-1}) = T(\varphi)^{-1}\).
\end{deduction}

\begin{proof}

  (1) 任取\(V\)的基\(\{e_1,e_2,\cdots,e_n\}\),
  \(I_V(e_i)=e_i \Longrightarrow T(I_V)=I_n \).

  (2)证明必要性：设\(\varphi\)为自同构，则\( I_V = \varphi\cdot\varphi^{-1} = \varphi^{-1}\cdot\varphi \).\\
  \( I_n = T(I_V) = T(\varphi\cdot\varphi^{-1}) = T(\varphi)\cdot T(\varphi^{-1})
  \Longrightarrow T(\varphi)\text{为可逆阵且}T(\varphi^{-1})=T(\varphi)^{-1} \).

  证明充分性：设\(T(\varphi)\)为可逆阵，即\(T(\varphi)^{-1}\)存在.
  \(T:\mathcal{L}(V) \longrightarrow M_n(\mathbb{K})\)为双射,
  根据其满性: \(\exists \psi \longmapsto T(\varphi)^{-1}\), 即\(T(\psi) = T(\varphi)^{-1}\),
  即\( I_n = T(\varphi)\cdot T(\psi) = T(\psi)\cdot T(\varphi)
  \Longrightarrow T(I_V) = T(\varphi\circ\psi) = T(\psi\circ\varphi)
  \xLongrightarrow {\text{单性}}I_V = \varphi\psi=\psi\varphi
  \Longrightarrow \psi = \varphi^{-1}\), \(\varphi\)为自同构.
\end{proof}

\subsection{线性映射的像与核}
\begin{theorem}\label{thm:ImKer1}
  设$\varphi : V^n \longrightarrow U^m$为线性映射，设$V$的一组基为
  $\{e_1,e_2,\cdots,e_n\}$, $U$的一组基为$\{f_1,f_2,\cdots,f_m\}$,
  $\varphi$在给定基下的表示矩阵为$A \in M_{m \times n}(\mathbb{K}) $.
  则$ \rank(\varphi) = \rank(A)$, $ \DIM\KER\varphi = n - \rank(A) $.
\end{theorem}

\begin{proof}
  参看下面映射交换图：%% 需要使用amscd包
  % \[\begin{CD}
  %     V @>{\varphi}>> U \\
  %     @V{\eta_V}V{\cong}V @V{\cong}V{\eta_U}V\\
  %     \mathbb{K}^n @>{\varphi_A} >> \mathbb{K}^m
  %   \end{CD}\]
  \begin{figure}[!ht]\centering
      $\begin{CD}
      V @>{\varphi}>> U \\
      @V{\eta_V}V{\cong}V @V{\cong}V{\eta_U}V\\
      \mathbb{K}^n @>{\varphi_A} >> \mathbb{K}^m
    \end{CD}$
    \caption{映射交换图\label{fig:ImKer1}}
  \end{figure}    
  上图中，$\eta_U\circ\varphi = \varphi_A\circ\eta_V$.
  只需证$ \KER\varphi \cong \KER\varphi_A$, $ \IM\varphi \cong \IM\varphi_A $.

  Step1: 先证$ \eta_V(\KER\varphi) \subseteq \KER\varphi_A $,
  $ \eta_U(\IM\varphi) \subseteq \IM\varphi_A $.

  （1）任取$ v\in \KER\varphi$, 只要证$\eta_V(v) \in \KER\varphi_A$.\\ 
  $ \because \varphi_A(\eta_V(v)) = \eta_U(\varphi(v)) = \eta_U(0) = 0 $, 得证.

  (2) 任取$ \varphi(v) \in \IM\varphi $, $ v \in V $,
  只要证$ \eta_U(\varphi(v)) \in \IM\varphi_A$.\\
  $ \because \eta_U(\varphi(v)) = \varphi_A(\eta_V(v)) \in \IM\varphi_A $, 得证.

  Step2: 作限制:  
  $ \eta_V: \KER\varphi \longrightarrow \KER\varphi_A $, 
  $ \eta_U: \IM\varphi \longrightarrow \IM\varphi_A $.\\
  二者都是单线性映射, 只需证明以上两个映射是满射.

  (1)先证$ \eta_V: \KER\varphi \longrightarrow \KER\varphi_A $
  是满射：

  $ \because $ 任取 $ x \in \KER\varphi_A $, 即$ \varphi_A(x) = 0 $,
  $ x \in \KER\varphi_A \subseteq \mathbb{K}^n $
  且$ \eta_V: V \longrightarrow \mathbb{K}^n $是满射,
  从而$ \exists v \in V \st \eta_V(v) = x $.
  $\eta_U(\varphi(v)) = \varphi_A(\eta_V(v)) = \varphi_A(x) = 0 $,
  由$ \eta_U $为同构可知，$\varphi(v) = 0 $, 即$ v \in \KER\varphi $.

  (2)再证$ \eta_U: \IM\varphi \longrightarrow \IM\varphi_A $是满射.
  
  $\because$任取$ \varphi_A(x) \in \IM\varphi_A  $, 其中$x \in \mathbb{K}^n$.
  取$ v \in V \st \eta_V(v) = x $.
  $ \eta_U(\varphi(v)) = \varphi_A(\eta_V(v)) = \varphi_A(x) $,
  $ \varphi(v) \in \IM\varphi $. 从而
  $ \eta_U: \IM\varphi \longrightarrow \IM\varphi_A $是满射.

  Step3: $ \KER\varphi_A =\{x \in \mathbb{K}_n|Ax=0\} $即
  $ \KER\varphi_A $为$ Ax=0 $的解空间$ V_A $.\\
  $ \KER\varphi \cong \KER\varphi_A \Longrightarrow
  \DIM\KER\varphi = \DIM\KER\varphi_A = \DIM V_A = n-\rank(A)$.

  作列分块$ A = (\alpha_1,\alpha_2,\cdots,\alpha_n) $, 其中
  $ \alpha_i \in \mathbb{K}_m$,\\
  另$ \IM\varphi_A = \{Ax|x \in \mathbb{K}_n\} $,其中  
  $ x = \left(\begin{smallmatrix}
    x_1\\
    x_2\\
    \cdots\\
    x_n \end{smallmatrix}\right) \in \mathbb{K}_n $, \\
  从而推出$ \IM\varphi_A = \{
  x_1\alpha_1+x_2\alpha_2+\cdots+x_n\alpha_n|x_i \in \mathbb{K}\}
  = L(\alpha_1, \alpha_2, \cdots, \alpha_n)$.\\
  $ \IM\varphi \cong \IM\varphi_A \Longrightarrow
  \rank(\varphi) = \DIM\IM\varphi = \DIM\IM\varphi_A
  = \DIM\ L(\alpha_1, \alpha_2, \cdots, \alpha_n)\\
  = \rank(\{\alpha_1, \alpha_2, \cdots, \alpha_n\}) = \rank(A) $.
\end{proof}

\begin{deduction}[线性映射的维数公式]\label{thm:ImKer2}
  设$\varphi: V^n \longrightarrow U^m$为线性映射, 则\\
  $\DIM\KER\varphi + \DIM\IM\varphi = \DIM V$.
\end{deduction}

\begin{proof}
  $\because$ 根据定理\ref{thm:ImKer1}, $\DIM\KER\varphi = n - \rank(A)$,
  $\DIM\IM\varphi = \rank(A)$\\
  $\therefore \DIM\KER\varphi + \DIM\IM\varphi = n = \DIM V$.
\end{proof}

\begin{deduction}
  设$\varphi: V^n \longrightarrow U^m$为线性映射,
  $\varphi$在某组基下的表示矩阵为$A^{m \times n}$， 则

  （1）$\varphi$为满射$\Longleftrightarrow A$为行满稚矩阵，即$\rank(A) = m$;

   (2) $\varphi$为单射$\Longleftrightarrow A$为列满稚矩阵，即$\rank(A) = n$. 
 \end{deduction}

 \begin{proof}
   (1)根据定理\ref{thm:ImKer1}:
   \begin{align*}
        & \varphi \text{是满射} \Longleftrightarrow \DIM\IM\varphi = \DIM U = m\\
        & \xLongleftrightarrow {\rank(\varphi) = \rank(A)} \DIM\IM\varphi = \rank(A) = m
   \end{align*}

   (2)根据定理\ref{thm:ImKer1}:
   \begin{align*}
        & \varphi \text{是单射} \Longleftrightarrow \DIM\KER\varphi = 0\\
        & \xLongleftrightarrow {\DIM\KER\varphi = n - \rank(A)} \rank(A) = n
   \end{align*}
 \end{proof}

\begin{deduction}\label{thm:ImKer3}
  设$\varphi: V^n \longrightarrow U^n$为线性映射且$\DIM V = \DIM U = n$,则以下结论等价：

  (1)$\varphi$为单射;

  (2)$\varphi$为满射;

  (3)$\varphi$为同构. 
\end{deduction}

\begin{proof}

  （1）设$\varphi$为单射，只要证$\varphi$为满射.
  \begin{align*}
    & \because 0 = \DIM\KER\varphi = \DIM V - \DIM\IM\varphi\\
    \Longrightarrow & \DIM\IM\varphi = \DIM V = \DIM U\\
    \Longrightarrow & \IM\varphi = U
  \end{align*}

  (2)设$\varphi$为满射，只要证$\varphi$为单射.
  \begin{align*}
    &\IM\varphi = U \Longrightarrow \DIM\IM\varphi = \DIM U = \DIM V\\
    \Longrightarrow & \DIM\KER\varphi = 0 \Longrightarrow \KER\varphi = 0
  \end{align*}.

  (3)由以上(1)和(2)可得.

  特别地，当$\varphi \in \mathcal{L}(V^n)$时, $\varphi$为自同构
  $\Longleftrightarrow \varphi$为单射$\Longleftrightarrow \varphi$为满射. 
\end{proof}

\begin{deduction}
  设$\varphi \in \mathcal{L}(V^n)$, 则: \\
  $\varphi$为满射或单射 $\Longleftrightarrow \varphi$在任一组基下
  的表示矩阵可逆. 
\end{deduction}

\begin{proof}
  从几何角度证明：
  由推论\ref{thm:ImKer3}可知，
  $\varphi$为满射或单射$\Longleftrightarrow \varphi$为自同构
  $\Longleftrightarrow \varphi$在任一组基下表示矩阵可逆.

  从代数角度证明：
  $\varphi$为满射或单射 $\Longleftrightarrow A^{n \times n}$为行或列满稚矩阵
  $\Longleftrightarrow A$为非异矩阵. 
\end{proof}

\begin{example}
  设$\varphi: V^n \Longrightarrow U^m$为线性映射，
  $V$的一组基为$\{e_1, e_2,\cdots,e_n\}$,
  $U$的一组基为$\{f_1, f_2,\cdots,f_m\}$.
  计算:

  (1)$\KER\varphi$用$e_i$的线性组合表示;

  (2)$\IM\varphi$用$f_i$的线性组合表示. 
\end{example}

\begin{solution}
  参考图\ref{fig:ImKer1}:
  
  $\eta_V: \KER\varphi \longrightarrow \KER\varphi_A$为线性同构.
  该映射将$V$中任意向量$v$映射成其坐标向量， 即
  $v \mapsto (x_1, x_2,\cdots,x_n)'$; 
  其逆映射为$\eta_V^{-1}: \KER\varphi_A \longrightarrow \KER\varphi$,
  该映射将核空间中向量的坐标映射回核空间中的向量， 即
  $(x_1, x_2, \cdots, x_n)' \mapsto x_1e_1 + x_2e_2+ \cdots + x_ne_n$. 

  同理， $\eta_U: \IM\varphi \longrightarrow \IM\varphi_A$为线性同构,
  其逆映射为$\eta_U^{-1}: \IM\varphi_A \longrightarrow \IM\varphi$, 
  将像的坐标向量映射回像向量，即
  $(y_1, y_2, \cdots, y_m)' \mapsto y_1f_1 + y_2f_2+ \cdots + y_mf_m$.

  根据定理\ref{thm:ImKer1}中的证明中Step3中所述，
  $\KER\varphi =\{x \in \mathbb{K}_n|Ax=0\}$
  即$\KER\varphi_A$为$Ax = 0$的解空间,
  又$\IM\varphi_A = \{Ax|x \in \mathbb{K}_n\}
  = L(\alpha_1, \alpha_2, \cdots, \alpha_n)$， 即
  $\IM\varphi_A$为$A$的列向量张成的子空间.

  \textbf{计算方法：}

  (1)对表示矩阵$A$实施初等行变换（必要时进行列对换):
  
  得到$A$的列向量极大无关组$\{\alpha_{i_1},\alpha_{i_2},\cdots,\alpha_{i_r}\}$,
  $r = \rank(A)$;

  得到$Ax=0$的基础解系$\{\beta_1,\beta_2,\cdots,\beta_{n-r}\}$.
  
  (2)算出$\KER\varphi$和$\IM\varphi$: 
  \begin{align*}
       & \KER\varphi = k_1\eta_V^{-1}(\beta_1)+k_2\eta_V^{-1}(\beta_2)
         +\cdots+k_{n-r}\eta_V^{-1}(\beta_{n-r}), k \in \mathbb{K}\\
       & \IM\varphi = l_1\eta_U^{-1}(\alpha_{i_1})+l_2\eta_U^{-1}(\alpha_{i_2})
         \cdots+l_r\eta_U^{-1}(\alpha_{i_r}), l \in \mathbb{K}      
   \end{align*} 
 \end{solution}

 \begin{example}
   $V^5$, $U^4$为$\mathbb{K}$上两个线性空间且
   $\varphi: V \longrightarrow U$为线性映射，
   $\{e_1,e_2,e_3,e_4,\\
   e_5\}$为$V$的基，
   $\{f_1,f_2,f_3,f_4\}$为$U$的基. 
   $\varphi$在上述基下的表示矩阵为
   \[A=
     \begin{pmatrix}
     1 & 2 & 1 &-3 & 2\\
     2 & 1 & 1 & 1 &-3\\
     1 & 1 & 2 & 2 &-2\\
     2 & 3 &-5 &-17&10
   \end{pmatrix}, \]
   求$\IM\varphi$和$\KER\varphi$. 
 \end{example}

 \begin{solution}
   将表示矩阵$A$做行变换，
   \[A=
     \begin{pmatrix}
     1 & 2 & 1 &-3 & 2\\
     2 & 1 & 1 & 1 &-3\\
     1 & 1 & 2 & 2 &-2\\
     2 & 3 &-5 &-17&10
   \end{pmatrix} \longrightarrow
   \begin{pmatrix}
     1 & 0 & 0 & 1 & -\frac{9}{4}\\
     0 & 1 & 0 &-3 &  \frac{11}{4}\\
     0 & 0 & 1 & 2 & -\frac{5}{4}\\
     0 & 0 & 0 & 0 &  0
   \end{pmatrix}
 \]
 其中，$A$的最大无关列向量组为\[
   \{\alpha_1,\alpha_2,\alpha_3\} = \left\{
       \begin{pmatrix}
         1\\
         2\\
         1\\
         2
       \end{pmatrix},
       \begin{pmatrix}
         2\\
         1\\
         1\\
         3
       \end{pmatrix},
       \begin{pmatrix}
         1\\
         1\\
         2\\
         -5
       \end{pmatrix}\right\}, \]
  $\IM\varphi = k_1(f_1+2f_2+f_3+2f_4) + k_2(2f_1+f_2+f_3+3f_4)
  +k_3(f_1+f_2+2f_3-5f_4)$, $k \in \mathbb{K}$;\\
  $Ax = 0$的基础解系为\[
    \beta_1 =
    \begin{pmatrix}
      -1\\
      3\\
      -2\\
      1\\
      0
    \end{pmatrix},
    \beta_2 = 
    \begin{pmatrix}
      9\\
      -11\\
      5\\
      0\\
      4
    \end{pmatrix}, \]
  \[\KER\varphi = l_1(-e_1+3e_2-2e_3+e_4)
    +l_2(9e_1-11e_2+5e_3+4e_5), l \in \mathbb{K}.\]
\end{solution}

\subsection{不变子空间}
\begin{example}
  设$\varphi \in \mathcal{L}(V)$是纯量变换，
  即$\varphi(\alpha) = k\alpha$, 其中$k \in \mathbb{K}$固定,
  则$V$的任一子空间都是$\varphi-\text{不变子空间}$. 
\end{example}

\begin{theory}\label{thm:ImKer4}
  设$\varphi \in \mathcal{L}(V)$, $U = L(\alpha_1,\alpha_2,\cdots,\alpha_m)$,
  其中，$\alpha_i \in V$, 则
  $U$为$\varphi-\text{不变子空间}$ $\Longleftrightarrow \varphi(\alpha_i) \in U$,
  $\forall 1 \leq i \leq m$. 
\end{theory}

\begin{proof}

  先证必要性: $U$是$\varphi-\text{不变子空间}$, 由不变子空间的定义可知，
  $\varphi(\alpha_i) \in U$.

  再证必要性: 设$\varphi(\alpha_i) \in U$, $1 \leq i \leq m$. \\
  任取$\alpha \in U$, 可设
  $\alpha = \lambda_1\alpha_1+\lambda_2\alpha_2+
    \cdots+\lambda_m\alpha_m$, $\lambda_i \in \mathbb{K}$, \\
  则$\varphi(\alpha)=\lambda_1\varphi(\alpha_1)+\lambda_2\varphi(\alpha_2)
  +\cdots+\lambda_m\varphi(\alpha_m) \in U$.
\end{proof}

\begin{theorem}\label{thm:ImKer5}
  设$\varphi \in \mathcal{L}(V^n)$, $U$是$\varphi-\text{不变子空间}$,
  取$U$的一组基$\{e_1, e_2,\cdots,e_r\}$, 再扩张为$V$的基
  $\{e_1,e_2,\cdots,e_r,e_{r+1},\cdots,e_n\}$,
  则$\varphi$在上述基下的表示矩阵为$\left(\begin{smallmatrix}
    A & B\\
    O & D
    \end{smallmatrix}\right)$. 
\end{theorem}

\begin{proof}
  由不变子空间的定义可知, $\varphi(e_i) \in U (1 \leq i \leq r)$,
  \begin{align*}
    \varphi(e_1) & = a_{11}e_1 + a_{21}e_2 + \cdots + a{r1}e_r,\\
    \varphi(e_2) & = a_{12}e_1 + a_{22}e_2 + \cdots + a{r2}e_r,\\
                 & \cdots\\
    \varphi(e_r) & = a_{1r}e_1 + a_{2r}e_2 + \cdots + a{rr}e_r,
  \end{align*}
  \[\therefore (\varphi(e_1),\varphi(e_2),\cdots,\varphi(e_n)) =
    (e_1,e_2,\cdots,e_n)
    \begin{pmatrix}
      A & B\\
      O & D
    \end{pmatrix}\]
\end{proof}

\begin{notice}
  定理\ref{thm:ImKer5}的逆命题也成立：
  设$\varphi \in \mathcal{L}(V^n)$, $\varphi$在一组基$\{e_1,e_2,\cdots,e_n\}$
  下的表示矩阵为$\left(
    \begin{smallmatrix}
      A & B\\
      O & D
    \end{smallmatrix}\right)$. 令$U=L(e_1,e_2,\cdots,e_r)$,
  则$U$是$\varphi-\text{不变子空间}$. 
\end{notice}
\begin{proof}
  由引理\ref{thm:ImKer4} $\Longrightarrow $
  只要$\varphi(e_i) \in U$, $\forall 1 \leq i \leq r$. \\
  由表示矩阵定义可知: \\
  $(\varphi(e_1), \varphi(e_2), \cdots, \varphi(e_r), \cdots, e_n)
  = (e_1, e_2, \cdots, e_r, \cdots, e_n)
  \begin{pmatrix}
    A^{r \times r} & B^{r\times(n-r)}\\
    O & D^{(n-r)\times(n-r)}
  \end{pmatrix}\\
  \Longrightarrow \varphi(e_i) \in U, \forall 1 \leq i \leq r. $
\end{proof}

\begin{theory}
  设$\varphi \in \mathcal{L}(V^n)$, $V = V_1 \oplus V_2$, 
  其中，$V_1$, $V_2$都是$\varphi-\text{不变子空间}$，
  则可取$V_1$, $V_2$的一组基拼成$V$的一组基， 使得
  $\varphi$在这组基下的表示矩阵为$\left(
    \begin{smallmatrix}
      A & O\\
      O & D
    \end{smallmatrix}\right)$. 
\end{theory}

\begin{proof}
  取$V1$的基$\{e_1, e_2, \cdots, e_r\}$及$V2$的基$\{e_{r+1}, e_{r+2}, \cdots, e_n\}$ \\
  $\Longrightarrow \varphi(e_i) \in V_1(1 \leq i \leq r)$, 
  $\varphi(e_j) \in V_2(r+1 \leq j \leq n)$\\
  $\Longrightarrow \varphi(e_1), \varphi(e_2), \cdots, \varphi(e_r), \cdots, e_n)
  = (e_1, e_2, \cdots, e_r, \cdots, e_n)
  \begin{pmatrix}
    A^{r \times r} & O\\
    O & D^{(n-r)\times(n-r)}
  \end{pmatrix}$ 
\end{proof}

\begin{generalize}
  设$\varphi \in \mathcal{L}(V^n)$, $V = V_1 \oplus V_2 \oplus\cdots\oplus V_m$, 
  其中$V_i$均为$\varphi-\text{不变子空间}$， 取定$V_i$的基，
  设$\varphi|_{V_i}$在给定基下的表示矩阵为$A_i(1 \leq i \leq m)$.
  将$V_i$的基拼成$V$的基，则$\varphi$的表示矩阵为diag$\{A_1, A_2, \cdots, A_m\}$. 
\end{generalize}

\begin{example}
  $V^3$的基为$\{e_1, e_2, e_3\}$, $\varphi \in \mathcal{L}(V)$的表示矩阵为
  $A=\begin{pmatrix}
    3 & 1 & -1\\
    2 & 2 & -1\\
    2 & 2 &  0
  \end{pmatrix}$.求证: \\
  $U = L(e_3, e_1+e_2+2e_3)$是$\varphi-\text{不变子空间}$. 
\end{example}

\begin{proof}
  由引理\ref{thm:ImKer4} $\Longrightarrow$ 只要证$\varphi(e_3) \in U$,
  $\varphi(e_1+e_2+2e_3) \in U$. 

  \textbf{方法一：直接验证}
  
  $\because \eta: V \longrightarrow \mathbb{K}^3$为线性同构，
  $\therefore$ 只要对坐标向量进行验证即可. \\
  $\because e_3 \mapsto
  \begin{pmatrix}
    0\\
    0\\
    1
  \end{pmatrix},e_1+e_2+2e_3 \mapsto
  \begin{pmatrix}
    1\\
    1\\
    2
  \end{pmatrix}$, \\
  $\therefore \varphi(e_3) = A
  \begin{pmatrix}
    0\\
    0\\
    1
  \end{pmatrix} =
  \begin{pmatrix}
    -1\\
    -1\\
    0
  \end{pmatrix}$, 
  $\varphi(e_1+e_2+2e_3) = A
  \begin{pmatrix}
    1\\
    1\\
    2
  \end{pmatrix} =
  \begin{pmatrix}
    2\\
    2\\
    4
  \end{pmatrix}$. \\
  因此$\varphi(e_3) = -(e_1+e_2+2e_3) + 2e_3$, 
  $\varphi(e_1+e_2+2e_3) = 2(e_1+e_2+2e_3)$\\
  所以, $\varphi(e_3) \in U$, $\varphi(e_1+e_2+2e_3) \in U$.

  \textbf{方法二：证明$\varphi(e_3)$和$\varphi(e_1+e_2+2e_3)$是$e_3$和$e_1+e_2+2e_3$的线性组合}

  $\because \rank U = \rank(e_3,e_1+e_2+2e_3) = \rank
  \begin{pmatrix}
    0 & 1\\
    0 & 1\\
    1 & 2
  \end{pmatrix} = 2$, \\
  $\therefore$ 只要证$\rank(\varphi(e_3), e_3, e_1+e_2+2e_3) =
  \rank(\varphi(e_1+e_2+2e_3), e_3, e_1+e_2+2e_3) = 2$即可. \\
  显然， $\rank(\varphi(e_3), e_3, e_1+e_2+2e_3) = \rank
  \begin{pmatrix}
    -1 & 0 & 1\\
    -1 & 0 & 1\\
     0 & 1 & 2
   \end{pmatrix} = 2$, \\
   $\rank(\varphi(e_1+e_2+2e_3), e_3, e_1+e_2+2e_3) = \rank
   \begin{pmatrix}
     2 & 0 & 1\\
     2 & 0 & 1\\
     4 & 1 & 2
   \end{pmatrix} = 2$.
 \end{proof}
 从图\ref{fig:ImKer1}可以看出，上面是线性空间表示的几何语言，下面是向量空间表示的代数语言，很多问题可以在几何和代数之间互相转化。

\textbf{1.几何转化成代数}

\begin{example}
  设$\varphi \in \mathcal{L}(V, U)$, $\rank(\varphi) = r \geq 1$,
  求证: 存在$\varphi_i \in \mathcal{L}(V, U)$, $\rank(\varphi_i) = 1$且
  $\varphi = \varphi_1+\varphi_2+\cdots+\varphi_r$.
\end{example}

\begin{proof}
  设$A \in M_{m \times n}(\mathbb{K})$, $\rank(A) = r \geq 1$.\\
  只需证明$\exists A_i \in M_{m \times n}(\mathbb{K})$, $\rank(A_i) = 1$且
  $A = A_1+A_2+\cdots+A_r$. \\
  $\because \exists$非异阵$P$,$Q$ $\st A = 
  P\begin{pmatrix}
    I_r & O\\
    O   & O
  \end{pmatrix}Q$, \\
  设$E_{ij}(i=1,2,\cdots,m;j=1,2,\cdots,n)$是第$(i,j)$元素为1、其余所有元素为0的$m \times n$矩阵，
  令$A_i = PE_{ii}Q$, $1 \leq i \leq r$, 
  则$\rank(A_i)=1$且$A = A_1+A_2+\cdots+A_r$.
\end{proof}

\begin{example}
  设$\varphi \in \mathcal{L}(V^m)$, $\varphi^m=0, n=mq+1$,
  求证: $\rank(\varphi) \leq n-q-1$.
\end{example}

\begin{proof}
  设$A \in M_n(\mathbb{K})$, $A^m=0$, $n=mq+1$, 
  只要证$\rank(A) \leq n-q-1$.\\
  用反证法: 设$\rank(A) \geq n-q$.\\
  $\because 0 = \rank(A^m) = \rank(A^{m-1}\cdot A)
  \stackrel{\text{Sylvester不等式}}{\geq} \rank(A^{m-1})+\rank(A)- n
  \geq \rank(A^{m-1})-q$\\
  $\Longrightarrow \rank(A^{m-1}) \leq q$\\
  $\therefore q \geq \rank(A^{m-1}) = \rank(A^{m-2}\cdot A)
  \geq \rank(A^{m-2})+\rank(A)-n  \geq \rank(A^{m-2})-q$
  $\Longrightarrow \rank(A^{m-2}) \leq 2q
  \xLongrightarrow{\text{反复应用以上过程}}
  \cdots \Longrightarrow \rank(A) \leq (m-1)q$\\
  这与$\rank(A) \geq n-q \xlongequal {n=mq+1} (m-1)q+1$矛盾.
\end{proof}

\textbf{2.代数转化成几何}

\begin{example}
  设$A$是$n$阶方阵, 求证: $\rank(A^n) = \rank(A^{n+1}) = \rank(A^{n+2})=\cdots$. 
\end{example}

\begin{proof}
  转化成几何问题：
  设$\varphi \in \mathcal{L}(V^n)$, 则存在$m \in [0,n]$使得: 
  \begin{align}
    \IM\varphi^m &  = \IM\varphi^{m+1}=\cdots, \label{eq:ImKer1}\\
    \KER\varphi^m & = \KER\varphi^{m+1}=\cdots,\label{eq:ImKer2} \\
    V & = \KER\varphi^m\oplus\IM\varphi^m.\label{eq:ImKer3}
  \end{align}
  $\because \varphi^2(v) = \varphi(\varphi(v)) \in \IM\varphi$, 
  $\therefore V \supseteq \IM\varphi \supseteq \IM\varphi^2
  \supseteq \IM\varphi^3 \supseteq \cdots$, \\
  同理, $\because v \in \KER\varphi$时,
  $\varphi^2(v) = \varphi(\varphi(v))=\varphi(0) = 0$, \\
  $\therefore \KER\varphi \subseteq \KER\varphi^2
  \subseteq \KER\varphi^3
  \subseteq \cdots \subseteq V$.\\
  $\because V \supseteq \IM\varphi \supseteq \IM\varphi^2
  \supseteq \cdots \supseteq \IM\varphi^n \supseteq \IM\varphi^{n+1}$, \\
  $\therefore \DIM V = n \geq \DIM\IM\varphi \geq \DIM\IM\varphi^2
  \geq \DIM\IM\varphi^n \geq \DIM\IM\varphi^{n+1} \geq 0$, \\
  由抽屉原理，以上$n+2$个整数维数必有两个相等, \\
  不妨设$\exists m \in [0, n]$, $\st \DIM\IM\varphi^m = \DIM\IM\varphi^{m+1}$, \\
  上式等价于$\IM\varphi^m = \IM\varphi^{m+1}$,
  只要证$\forall k \geq m$, $\IM\varphi^k = \IM\varphi^{k+1}$. \\
  $\because \IM\varphi^{k+1} \subseteq \IM\varphi^k$,
  任取$\varphi^k(v) \in \IM\varphi^k$: \\
  $\varphi^m(v) \in \IM\varphi^m = \IM\varphi^{m+1}$,
  $\exists u \in V \st \varphi^m(v) = \varphi^{m+1}(u)$. \\
  $\varphi^k(v)= \varphi^{k-m}(\varphi^m(v)) =
  \varphi^{k-m}(\varphi^{m+1}(u)) = \varphi^{k+1}(u) \in \IM\varphi^{k+1}$. \\
  $\forall k \geq m$, $\DIM\KER\varphi^k + \DIM\IM\varphi^k = \DIM V = n$. \\
  上式中，$\forall k \geq m$, $\IM\varphi^k$的值不变，
  所以$\KER\varphi^k$的值亦不变.
  因此, \ref{eq:ImKer1}、\ref{eq:ImKer2}两式得证. \\
  下面证\ref{eq:ImKer3}式： \\
  \ding{172}先证$\KER\varphi^m \cap \IM\varphi^m=0$.\\
  $\because$任取$\alpha \in \KER\varphi^m \cap \IM\varphi^m$,
  即$\varphi^m(\alpha)=0$, $\alpha = \varphi^m(\beta) \Longrightarrow
  0 = \varphi^m(\alpha) = \varphi^{2m}(\beta)$\\
  即$\beta \in \KER\varphi^{2m} = \KER\varphi^m
  \Longrightarrow \varphi^m(\beta) = 0$. \\
  \ding{173}再证$V = \KER\varphi^m + \IM\varphi^m$. \\
  $\because$任取$\alpha \in V$,
  $\varphi^m(\alpha) \in \IM\varphi^m = \IM\varphi^{2m}$,
  $\exists \beta \in V \st \varphi^m(\alpha) = \varphi^{2m}(\beta)$ \\
  $\varphi^m(\alpha - \varphi^m(\beta))=0$,
  设$\alpha - \varphi^m(\beta) = \gamma$,
  即$\gamma \in \KER\varphi^m \Longrightarrow
  \alpha = \gamma + \varphi^m(\beta) \in \KER\varphi^m + \IM\varphi^m$. \\
  以上证毕。此外，由\ding{172}亦可结合维数公式
  $\Longrightarrow V = \KER\varphi^m \oplus \IM\varphi^m$.
\end{proof}

\begin{example}
  证明线性映射的维数公式：$\varphi \in \mathcal{L}(V^n,U^m)$, 则
  $\DIM\KER\varphi+\DIM\IM\varphi=\DIM V = n$.
\end{example}

\begin{proof}
  任取$\KER\varphi$的一组基$\{e_1,e_2,\cdots,e_k\}$,扩展为$V$的一组基
  $\{e_1,e_2,\cdots,e_k,e_{k+1},\cdots,\\e_n\}$,
  $\forall \alpha \in V$,
  设$\alpha=\sum_{i=1}^n\lambda_ie_i$,
  则:\\
  $\varphi(\alpha)=\sum_{i=1}^n\lambda_i\varphi(e_i)
  =\lambda_{k+1}\varphi(e_{k+1})+\lambda_{k+2}\varphi(e_{k+2})+\cdots
  +\lambda_n\varphi(e_n)$.\\
  $\Longrightarrow \IM\varphi =
  L(\varphi(e_{k+1}),\varphi(e_{k+2}),\cdots,\varphi(e_n))$,
  只要证: $\varphi(e_{k+1}),\varphi(e_{k+2}),\cdots,\varphi(e_n)$线性无关.\\
  设$c_{k+1}\varphi(e_{k+1})+c_{k+2}\varphi(e_{k+2})+\cdots+c_n\varphi(e_n)=0$,
  则$\varphi(c_{k+1}e_{k+1}+c_{k+2}e_{k+2}+\cdots+c_ne_n)=0$,\\
  因此, $c_{k+1}e_{k+1}+c_{k+2}e_{k+2}+\cdots+c_ne_n \in \KER\varphi\\
  \Longrightarrow c_{k+1}e_{k+1}+c_{k+2}e_{k+2}+\cdots+c_ne_n =
  -c_1e_1-c_2e_2-\cdots-c_ke_k\\
  \Longrightarrow c_1e_1+c_2e_2+\cdots+c_ke_k+c_{k+1}e_{k+1}+\cdots+c_ne_n=0$.\\
  $\because \{e_1,e_2,\cdots,e_k,e_{k+1},\cdots,e_n\}$是$V$的一组基，
  $\therefore c_1=c_2=\cdots=c_k=c_{k+1}=\cdots=c_n=0$
\end{proof}

\begin{example}
  设$A$,$B$都是$m \times n$矩阵,求证:方程组$Ax=0$, $Bx=0$同解的充分必要条件是
  存在$m$阶非异阵$P$, 使$B=PA$.
\end{example}

\begin{proof}
  转换成几何表述:\\
  设$\varphi,\psi \in \mathcal{L}(V^n,U^m)$,
  $\KER\varphi = \KER\psi$的充分必要条件是
  $\exists$自同构$\xi \in \mathcal{L}(U) \st \psi=\xi\varphi$.
\end{proof}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
